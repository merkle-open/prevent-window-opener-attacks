{"version":3,"file":"lib.min.js","sources":["../src/lib.js"],"sourcesContent":["'use strict';\r\n\r\nfunction preventWindowOpenerAttacks(clickEvent) {\r\n  document.documentElement.removeEventListener(\r\n    'click',\r\n    preventWindowOpenerAttacks\r\n  );\r\n  // Stop if any other javascript prevented the event\r\n  if (clickEvent.defaultPrevented) {\r\n    return;\r\n  }\r\n  // Stop if the clicked element is not an \"A\" element\r\n  if (!clickEvent.target || clickEvent.target.nodeName !== 'A') {\r\n    return;\r\n  }\r\n  // Stop if the clicked a element is not set to target = _blank\r\n  if (clickEvent.target.target !== '_blank') {\r\n    return;\r\n  }\r\n\r\n  clickEvent.preventDefault();\r\n  // noreferrer will automatically set window.opener to null if supported by the browser\r\n  const win = window.open(clickEvent.target.href, '_blank', 'noreferrer');\r\n  // Ensure that window.opener is set to null in every browser\r\n  if (win) {\r\n    win.opener = null;\r\n  }\r\n}\r\n\r\nexport function startProtection() {\r\n  // Add event listener to documentElement just before it bubbles up\r\n  document.body.addEventListener('click', function (e) {\r\n    // Ensure that previous events are cleaned up even if the event did not bubble\r\n    document.documentElement.removeEventListener(\r\n      'click',\r\n      preventWindowOpenerAttacks\r\n    );\r\n    // Wait for the current event to bubble to the documentElement\r\n    document.documentElement.addEventListener(\r\n      'click',\r\n      preventWindowOpenerAttacks\r\n    );\r\n  });\r\n}\r\n\r\nexport function patchWindowOpen() {\r\n  const originalWindowOpen = window.open;\r\n  window.open = function (url, target) {\r\n    const result = originalWindowOpen.apply(this, arguments);\r\n    if (result && target === '_blank') {\r\n      result.opener = null;\r\n    }\r\n    return result;\r\n  };\r\n}\r\n"],"names":["preventWindowOpenerAttacks","clickEvent","document","documentElement","removeEventListener","defaultPrevented","target","nodeName","preventDefault","win","window","open","href","opener","originalWindowOpen","url","result","apply","this","arguments","body","addEventListener","e"],"mappings":"gQAEA,SAASA,EAA2BC,GAMlC,GALAC,SAASC,gBAAgBC,oBACvB,QACAJ,GAGEC,EAAWI,iBACb,OAGF,IAAKJ,EAAWK,QAAyC,MAA/BL,EAAWK,OAAOC,SAC1C,OAGF,GAAiC,WAA7BN,EAAWK,OAAOA,OACpB,OAGFL,EAAWO,iBAEX,MAAMC,EAAMC,OAAOC,KAAKV,EAAWK,OAAOM,KAAM,SAAU,cAEtDH,IACFA,EAAII,OAAS,wBAoBV,WACL,MAAMC,EAAqBJ,OAAOC,KAClCD,OAAOC,KAAO,SAAUI,EAAKT,GAC3B,MAAMU,EAASF,EAAmBG,MAAMC,KAAMC,WAI9C,OAHIH,GAAqB,WAAXV,IACZU,EAAOH,OAAS,MAEXG,sBAvBJ,WAELd,SAASkB,KAAKC,iBAAiB,SAAS,SAAUC,GAEhDpB,SAASC,gBAAgBC,oBACvB,QACAJ,GAGFE,SAASC,gBAAgBkB,iBACvB,QACArB"}